<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>UnrealJammer WebFlasher</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">

    <style>

        html, body {

            margin: 0;

            padding: 0;

            height: 100%;

            width: 100%;

            background-color: #000;

            color: #0F0;

            font-family: 'Share Tech Mono', monospace;

            overflow: hidden; /* Prevent scrollbars from appearing */

        }



        #matrix-canvas {

            position: fixed;

            top: 0;

            left: 0;

            width: 100%;

            height: 100%;

            z-index: 1; /* Behind the content */

        }



        .content-container {

            position: relative;

            z-index: 2; /* In front of the canvas */

            display: flex;

            justify-content: center;

            align-items: center;

            height: 100vh;

            text-align: center;

            padding: 1rem;

            box-sizing: border-box;

        }



        main {

            background-color: rgba(0, 0, 0, 0.85);

            border: 2px solid #0F0;

            padding: 2rem 3rem;

            max-width: 600px;

            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5), inset 0 0 15px rgba(0, 255, 0, 0.3);

        }



        h1 {

            color: #0c0; /* Made the green color slightly darker */

            text-shadow: 0 0 5px #0c0, 0 0 8px rgba(0, 255, 0, 0.3); /* Reduced the glow effect */

            margin-bottom: 0.5rem;

            letter-spacing: 2px;

        }



        p {

            color: #0F0;

            text-shadow: 0 0 3px #0F0;

            margin-bottom: 1.5rem;

            line-height: 1.6;

        }



        /* Styling for the web install button */

        esp-web-install-button {

            --esp-web-install-button-fill-color: #000;

            --esp-web-install-button-text-color: #0F0;

            --esp-web-install-button-border-color: #0F0;

            --esp-web-install-button-connecting-fill-color: #000;

            --esp-web-install-button-connected-fill-color: #000;

            --esp-web-install-button-progress-color: #0F0;

            --esp-web-install-button-progress-background-color: #050; /* Dark green for progress track */

            --esp-web-install-button-border-radius: 0px;

            --esp-web-install-button-font-family: 'Share Tech Mono', monospace;

            --esp-web-install-button-font-weight: bold;

            box-shadow: 0 0 10px #0F0;

            transition: all 0.2s ease-in-out;

        }

       

        esp-web-install-button:hover {

            box-shadow: 0 0 20px #0F0, 0 0 30px #0F0;

            transform: scale(1.05);

        }

       

        #logs-container {

            margin-top: 1.5rem;

            text-align: left;

            background-color: rgba(0, 10, 0, 0.5);

            color: #0F0;

            border: 1px solid #0F0;

            padding: 1rem;

            max-height: 200px;

            overflow-y: auto;

            font-size: 0.875rem;

            display: none; /* Hidden by default */

            box-shadow: inset 0 0 10px rgba(0, 255, 0, 0.3);

        }



        #error-message {

            margin-top: 1rem;

            color: #ff4141; /* A brighter red for the theme */

            font-weight: bold;

            text-shadow: 0 0 5px #ff4141;

            display: none; /* Hidden by default */

        }

    </style>

    <!-- Import the ESP Web Tools library -->

    <script

        type="module"

        src="https://unpkg.com/esp-web-tools@9.4.3/dist/web/install-button.js?module"

    ></script>

</head>

<body>

    <canvas id="matrix-canvas"></canvas>

    <div class="content-container">

        <main>

            <h1>UNREALJAMMER V1</h1>

            <p>

                INITIATE DIRECT HARDWARE INTERFACE. CONNECT TARGET DEVICE [ESP32] VIA USB PORTAL. SELECT COM PORT TO COMMENCE FIRMWARE INJECTION PROTOCOL.

            </p>



            <div id="button-container"></div>

           

            <div id="error-message"></div>



            <div id="logs-container">

                <pre id="logs">> SYSTEM LOG:</pre>

            </div>

        </main>

    </div>



    // ...existing code...
<script type="module">
    // MATRIX RAIN + PERSONALITY (optimized & playful)

    const canvas = document.getElementById('matrix-canvas');
    const ctx = canvas.getContext('2d', { alpha: false });

    let width = 0, height = 0;
    let fontSize = 16;
    let columns = 0;
    let drops = [];

    const katakana = 'アァカサタナハマヤャラワガザダバパイィキヒチニヒミリヰギジヂビピウゥクスツヌフムユュルグズブヅプエェケセテネヘメレヱゲゼデベペオォコソトノホモヨョロヲゴゾドボポヴッン';
    const latin = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    const nums = '0123456789';
    const chars = katakana + latin + nums;
    const charCount = chars.length;

    const dpr = Math.max(1, window.devicePixelRatio || 1);

    // Performance tuning
    const targetFPS = 18;
    const frameInterval = 1000 / targetFPS;
    let lastTime = 0;

    function resizeCanvas() {
        width = Math.floor(window.innerWidth);
        height = Math.floor(window.innerHeight);

        canvas.width = Math.floor(width * dpr);
        canvas.height = Math.floor(height * dpr);
        canvas.style.width = width + 'px';
        canvas.style.height = height + 'px';

        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

        // reduce columns on small screens
        fontSize = Math.max(12, Math.floor(Math.min(width, height) / 60));
        columns = Math.max(4, Math.floor(width / fontSize));
        drops = new Array(columns).fill(1);

        ctx.font = `${fontSize}px monospace`;
    }

    // debounce resize
    window.addEventListener('resize', () => {
        clearTimeout(window._matrixResizeTimer);
        window._matrixResizeTimer = setTimeout(resizeCanvas, 120);
    });

    resizeCanvas();

    function drawMatrix(now) {
        requestAnimationFrame(drawMatrix);

        if (!lastTime) lastTime = now;
        const delta = now - lastTime;
        if (delta < frameInterval) return;
        lastTime = now - (delta % frameInterval);

        // subtle fade to reduce overdraw and CPU
        ctx.fillStyle = 'rgba(0,0,0,0.08)';
        ctx.fillRect(0, 0, width, height);

        for (let i = 0; i < columns; i++) {
            const ch = chars.charAt(Math.floor(Math.random() * charCount));
            const x = i * fontSize;
            const y = drops[i] * fontSize;

            // occasional accent color for personality
            if (Math.random() > 0.995) {
                ctx.fillStyle = '#0FF';
                ctx.fillText(ch, x, y);
                ctx.fillStyle = '#0F0';
            } else {
                ctx.fillStyle = '#0F0';
                ctx.fillText(ch, x, y);
            }

            if (y > height && Math.random() > 0.975) {
                drops[i] = 0;
            }
            drops[i]++;
        }
    }

    requestAnimationFrame(drawMatrix);

    // --- UI PERSONALITY / TYPING STATUS ---
    const statusP = document.querySelector('main p');
    const originalStatus = statusP ? statusP.textContent.trim() : '';
    const personaLines = [
        "boots: warm ✔, coffee: pending ☕",
        "core: humming a pleasant tune (not strictly necessary)",
        "probe: sniffing USB traffic... polite, but curious",
        "flasher: ready to spill firmware — in a safe way",
        "watchdog: blinking an approving green light"
    ];

    let personaIndex = 0;
    let typingInterval = null;

    function typeText(target, text, speed = 28, cb) {
        target.textContent = '';
        let i = 0;
        clearInterval(typingInterval);
        typingInterval = setInterval(() => {
            target.textContent += text.charAt(i++);
            if (i >= text.length) {
                clearInterval(typingInterval);
                if (cb) setTimeout(cb, 800);
            }
        }, speed);
    }

    function cyclePersona() {
        const next = personaLines[personaIndex % personaLines.length];
        typeText(statusP, `STATUS: ${next}`, 22, () => {
            // after a short delay restore original
            setTimeout(() => typeText(statusP, originalStatus, 16), 1800);
        });
        personaIndex++;
    }

    // occasionally update the line for flavor
    setInterval(() => {
        if (document.hidden) return; // save CPU when tab is inactive
        cyclePersona();
    }, 7000 + Math.random() * 3000);

    // blinking cursor at the end of the console prompt
    const consolePrompt = document.getElementById('console-prompt');
    if (consolePrompt) {
        const cur = document.createElement('span');
        cur.className = 'pj-cursor';
        cur.textContent = '▌';
        cur.style.marginLeft = '6px';
        cur.style.color = '#0F0';
        consolePrompt.appendChild(cur);
        setInterval(() => {
            cur.style.visibility = (cur.style.visibility === 'hidden') ? 'visible' : 'hidden';
        }, 520);
    }

    // --- LOGGING WITH CHARACTER ---
    const buttonContainer = document.getElementById("button-container");
    const logsContainer = document.getElementById("logs-container");
    const logs = document.getElementById("logs");
    const errorMessage = document.getElementById("error-message");

    const installButton = document.createElement("esp-web-install-button");
    // swap to your own manifest if needed
    installButton.manifest = "https://raw.githubusercontent.com/CaseSkyDiver343/UnrealJammer/refs/heads/main/webflash/manifest.json";

    function appendLogLine(line, prefix = '>') {
        // keep logs as text nodes to avoid reflow heavy innerHTML ops
        const node = document.createTextNode(`\n${prefix} ${line}`);
        logs.appendChild(node);
        logsContainer.scrollTop = logsContainer.scrollHeight;
        logsContainer.style.display = 'block';
    }

    // add a playful heartbeat log every so often
    setInterval(() => {
        if (document.hidden) return;
        const quips = [
            "calibrating sarcasm module... minimal levels detected",
            "sweeping for gremlins: none found",
            "firmware whispers: 'all good here.'",
            "pro-tip: blinking LEDs look cooler when they blink together"
        ];
        appendLogLine(quips[Math.floor(Math.random() * quips.length)], '♥');
    }, 15000 + Math.random() * 10000);

    installButton.addEventListener("console", (e) => {
        errorMessage.style.display = "none";
        appendLogLine(e.detail.message, ':>');
    });

    installButton.addEventListener("error", (e) => {
        console.error("Flashing Error:", e.detail.message);
        errorMessage.innerText = `>> TRANSMISSION_ERROR: ${e.detail.message}`;
        errorMessage.style.display = "block";
        logsContainer.style.display = "none";
    });

    installButton.addEventListener("connected", () => {
        errorMessage.style.display = "none";
        // friendly connected message
        appendLogLine("Device connected. Handshake complete. Sending polite firmware...", '⊙');
    });

    buttonContainer.appendChild(installButton);

    // friendly guidance when tab is inactive
    document.addEventListener('visibilitychange', () => {
        if (document.hidden) {
            appendLogLine('Power-saving mode: matrix slowed to a nap.', '~');
        } else {
            appendLogLine('Welcome back. Resuming delightful espionage.', '~');
        }
    });
</script>


</body>

</html>
